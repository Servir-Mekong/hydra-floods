
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>datasets module - HYDRAFloods Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hydrafloods.datasets.Dataset" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="HYDRAFloods Documentation" class="md-header__button md-logo" aria-label="HYDRAFloods Documentation" data-md-component="logo">
      
  <img src="../img/hydrafloods_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HYDRAFloods Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datasets module
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="HYDRAFloods Documentation" class="md-nav__button md-logo" aria-label="HYDRAFloods Documentation" data-md-component="logo">
      
  <img src="../img/hydrafloods_logo.png" alt="logo">

    </a>
    HYDRAFloods Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../using-datasets/" class="md-nav__link">
        Using the Dataset class
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/" class="md-nav__link">
        Algorithms
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../workflow-example/" class="md-nav__link">
        Workflow Example
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../corrections/" class="md-nav__link">
        corrections module
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          datasets module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        datasets module
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset" class="md-nav__link">
    Dataset
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.collection" class="md-nav__link">
    collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.dates" class="md-nav__link">
    dates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.n_images" class="md-nav__link">
    n_images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.aggregate_time" class="md-nav__link">
    aggregate_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.apply_func" class="md-nav__link">
    apply_func()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.band_pass_adjustment" class="md-nav__link">
    band_pass_adjustment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.clip_to_region" class="md-nav__link">
    clip_to_region()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.filter" class="md-nav__link">
    filter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.from_imgcollection" class="md-nav__link">
    from_imgcollection()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.join" class="md-nav__link">
    join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1" class="md-nav__link">
    Sentinel1
  </a>
  
    <nav class="md-nav" aria-label="Sentinel1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.add_orbit_band" class="md-nav__link">
    add_orbit_band()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.to_db" class="md-nav__link">
    to_db()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.to_power" class="md-nav__link">
    to_power()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2" class="md-nav__link">
    Sentinel2
  </a>
  
    <nav class="md-nav" aria-label="Sentinel2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8" class="md-nav__link">
    Landsat8
  </a>
  
    <nav class="md-nav" aria-label="Landsat8">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7" class="md-nav__link">
    Landsat7
  </a>
  
    <nav class="md-nav" aria-label="Landsat7">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs" class="md-nav__link">
    Viirs
  </a>
  
    <nav class="md-nav" aria-label="Viirs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis" class="md-nav__link">
    Modis
  </a>
  
    <nav class="md-nav" aria-label="Modis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../depths/" class="md-nav__link">
        depths module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        decorators module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fetch/" class="md-nav__link">
        fetch module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../floods/" class="md-nav__link">
        floods module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../filtering/" class="md-nav__link">
        filtering module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fuzzy/" class="md-nav__link">
        fuzzy module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geeutils/" class="md-nav__link">
        geeutils module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../indices/" class="md-nav__link">
        indices module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        ml module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../thresholding/" class="md-nav__link">
        thresholding module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries/" class="md-nav__link">
        timeseries module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        utils module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dswfp/" class="md-nav__link">
        workflows.dswfp module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset" class="md-nav__link">
    Dataset
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.collection" class="md-nav__link">
    collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.dates" class="md-nav__link">
    dates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.n_images" class="md-nav__link">
    n_images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.aggregate_time" class="md-nav__link">
    aggregate_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.apply_func" class="md-nav__link">
    apply_func()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.band_pass_adjustment" class="md-nav__link">
    band_pass_adjustment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.clip_to_region" class="md-nav__link">
    clip_to_region()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.filter" class="md-nav__link">
    filter()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.from_imgcollection" class="md-nav__link">
    from_imgcollection()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.join" class="md-nav__link">
    join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Dataset.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1" class="md-nav__link">
    Sentinel1
  </a>
  
    <nav class="md-nav" aria-label="Sentinel1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.add_orbit_band" class="md-nav__link">
    add_orbit_band()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.to_db" class="md-nav__link">
    to_db()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel1.to_power" class="md-nav__link">
    to_power()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2" class="md-nav__link">
    Sentinel2
  </a>
  
    <nav class="md-nav" aria-label="Sentinel2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Sentinel2.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8" class="md-nav__link">
    Landsat8
  </a>
  
    <nav class="md-nav" aria-label="Landsat8">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat8.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7" class="md-nav__link">
    Landsat7
  </a>
  
    <nav class="md-nav" aria-label="Landsat7">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Landsat7.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs" class="md-nav__link">
    Viirs
  </a>
  
    <nav class="md-nav" aria-label="Viirs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Viirs.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis" class="md-nav__link">
    Modis
  </a>
  
    <nav class="md-nav" aria-label="Modis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hydrafloods.datasets.Modis.qa" class="md-nav__link">
    qa()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>datasets module</h1>

<!-- # datasets module -->



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Dataset">
        <code>
hydrafloods.datasets.Dataset        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Base dataset class used to define an EE image collection by datetime and geographic region</p>
<p>A dataset wraps an ee.ImageCollection by applying the spatial and temporal filtering upon init.
Provides utility functionality to make working with and managing image collections less verbose</p>

<p><strong>Examples:</strong></p>
    <p>Create a dataset object for Sentinel-1 data over Alabama for 2019</p>
    <div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span>
<span class="o">...</span>    <span class="n">region</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">([</span>
           <span class="o">-</span><span class="mf">88.473227</span><span class="p">,</span>
           <span class="mf">30.223334</span><span class="p">,</span>
           <span class="o">-</span><span class="mf">84.88908</span><span class="p">,</span>
           <span class="mf">35.008028</span>
       <span class="p">]),</span>
<span class="o">...</span>    <span class="n">start_time</span> <span class="o">=</span> <span class="s2">&quot;2019-01-01&quot;</span><span class="p">,</span>
<span class="o">...</span>    <span class="n">end_time</span> <span class="o">=</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span>
<span class="o">...</span>    <span class="n">asset_id</span> <span class="o">=</span> <span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ds</span>
<span class="n">HYDRAFloods</span> <span class="n">Dataset</span><span class="p">:</span>
<span class="p">{</span><span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="s1">&#39;COPERNICUS/S1_GRD&#39;</span><span class="p">,</span>
<span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span>
<span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dataset&#39;</span><span class="p">,</span>
<span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="p">[[[</span><span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="o">...</span><span class="p">]]],</span>
<span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-01-01&#39;</span><span class="p">}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Dataset</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base dataset class used to define an EE image collection by datetime and geographic region</span>

<span class="sd">    A dataset wraps an ee.ImageCollection by applying the spatial and temporal filtering upon init.</span>
<span class="sd">    Provides utility functionality to make working with and managing image collections less verbose</span>

<span class="sd">    Example:</span>
<span class="sd">        Create a dataset object for Sentinel-1 data over Alabama for 2019</span>
<span class="sd">        &gt;&gt;&gt; ds = Dataset(</span>
<span class="sd">        ...    region = ee.Geometry.Rectangle([</span>
<span class="sd">                   -88.473227,</span>
<span class="sd">                   30.223334,</span>
<span class="sd">                   -84.88908,</span>
<span class="sd">                   35.008028</span>
<span class="sd">               ]),</span>
<span class="sd">        ...    start_time = &quot;2019-01-01&quot;,</span>
<span class="sd">        ...    end_time = &quot;2020-01-01&quot;,</span>
<span class="sd">        ...    asset_id = &quot;COPERNICUS/S1_GRD&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; ds</span>
<span class="sd">        HYDRAFloods Dataset:</span>
<span class="sd">        {&#39;asset_id&#39;: &#39;COPERNICUS/S1_GRD&#39;,</span>
<span class="sd">        &#39;end_time&#39;: &#39;2020-01-01&#39;,</span>
<span class="sd">        &#39;name&#39;: &#39;Dataset&#39;,</span>
<span class="sd">        &#39;region&#39;: [[[...], [...], [...], [...], [...]]],</span>
<span class="sd">        &#39;start_time&#39;: &#39;2019-01-01&#39;}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Dataset class</span>

<span class="sd">        args:</span>
<span class="sd">            region (ee.Geometry): earth engine geometry object to filter image collection by</span>
<span class="sd">            start_time (str | datetime.datetime): start time used to filter image collection</span>
<span class="sd">            end_time (str | datetime.datetime): end time used to filter image collection</span>
<span class="sd">            asset_id (str): asset id of earth engine collection</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use an internal function qa().</span>
<span class="sd">                Used for definining custom dataset objects</span>

<span class="sd">        raises:</span>
<span class="sd">            AttributeError: if qa() method is not defined and use_qa is True</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: add exceptions to check datatypes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>  <span class="c1"># dtype = ee.Geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">end_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="n">asset_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_qa</span> <span class="o">=</span> <span class="n">use_qa</span>

        <span class="c1"># dictionary mapping of band names used to harmonized optical datasets to same names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;landsat7&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;SR_B1&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">]),</span>
                <span class="s2">&quot;landsat8&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B6&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">]),</span>
                <span class="s2">&quot;viirs&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;M2&quot;</span><span class="p">,</span> <span class="s2">&quot;M4&quot;</span><span class="p">,</span> <span class="s2">&quot;I1&quot;</span><span class="p">,</span> <span class="s2">&quot;I2&quot;</span><span class="p">,</span> <span class="s2">&quot;I3&quot;</span><span class="p">,</span> <span class="s2">&quot;M11&quot;</span><span class="p">]),</span>
                <span class="s2">&quot;sen2&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B8&quot;</span><span class="p">,</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]),</span>
                <span class="s2">&quot;modis&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;sur_refl_b03&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sur_refl_b04&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sur_refl_b01&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sur_refl_b02&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sur_refl_b06&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sur_refl_b07&quot;</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="s2">&quot;new&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span> <span class="s2">&quot;swir1&quot;</span><span class="p">,</span> <span class="s2">&quot;swir2&quot;</span><span class="p">]),</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># get the image collection and filter by geographic region and date time</span>
        <span class="n">imgcollection</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># check if to apply arbitrary qa process on collection</span>
        <span class="c1"># qa function can be defined in custom objects extending dataset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_qa</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">imgcollection</span> <span class="o">=</span> <span class="n">imgcollection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qa</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="s2">&quot;qa() method is not defined...please define one or set `use_qa` to False&quot;</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">imgcollection</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># format datetime information</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">ststr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ststr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">etstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">etstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span>

        <span class="c1"># create dict of dataset information</span>
        <span class="n">objDict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">&quot;asset_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">,</span>
            <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="n">ststr</span><span class="p">,</span>
            <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="n">etstr</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(),</span>
        <span class="p">}</span>

        <span class="c1"># pretty format dict and return information</span>
        <span class="n">strRepr</span> <span class="o">=</span> <span class="n">pformat</span><span class="p">(</span><span class="n">objDict</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;HYDRAFloods Dataset:</span><span class="se">\n</span><span class="si">{</span><span class="n">strRepr</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;image collection object property wrapped by dataset&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span>

    <span class="nd">@collection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter function for collection property&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of images contained in the dataset&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dates of imagery contained in the image collection&quot;&quot;&quot;</span>
        <span class="n">eeDates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;YYYY-MM-dd HH:mm:ss.SSS&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">eeDates</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_imgcollection</span><span class="p">(</span><span class="n">img_collection</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Static method to convert an ee.ImageCollection object to a hf.Dataset object.</span>
<span class="sd">        This method will take some time as it uses computed ee Objects from the image collection</span>
<span class="sd">        propeties to populate the Dataset object properties (passing info from server to client)</span>

<span class="sd">        args:</span>
<span class="sd">            img_collection (ee.ImageCollection): computed ee.ImageCollection object to create a hf.Dataset</span>

<span class="sd">        returns:</span>
<span class="sd">            hf.Dataset: dataset object with property information directly from the ee.ImageCollection</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get region and date information</span>
        <span class="n">region</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">img_collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span>
            <span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">maxError</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="n">maxError</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># convert ee.Date info to string format</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">img_collection</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;YYYY-MM-dd HH:mm:ss.S&quot;</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># pull the date info to local strings</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

        <span class="c1"># get the collection id for `.asset_id` property</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">img_collection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">collection_id</span> <span class="o">==</span> <span class="s2">&quot;None&quot;</span><span class="p">:</span>
            <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;Custom ImageCollection&quot;</span>

        <span class="c1"># make a dummy dataset</span>
        <span class="n">dummy_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span>
            <span class="n">region</span><span class="p">,</span>
            <span class="n">start_time</span><span class="p">,</span>
            <span class="n">end_time</span><span class="p">,</span>
            <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;NOAA/VIIRS/001/VNP09GA&quot;</span><span class="p">,</span>
            <span class="n">use_qa</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># override the dummy dataset information with the correct data fr</span>
        <span class="n">dummy_ds</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="n">collection_id</span>
        <span class="n">dummy_ds</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">img_collection</span>

        <span class="k">return</span> <span class="n">dummy_ds</span>

    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_inplace_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">inplace</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Private helper function to replace the collection info for a class</span>
<span class="sd">        typically used when other class methods have inplace</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outCls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">outCls</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">collection</span>
            <span class="k">return</span> <span class="n">outCls</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns a deep copy of the hydrafloods dataset class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper method to apply a function to all of the image in the dataset.</span>
<span class="sd">        Makes a copy of the collection and reassigns the image collection property.</span>
<span class="sd">        Function must accept an ee.ImageCollection and return an ee.ImageCollection</span>

<span class="sd">        args:</span>
<span class="sd">            func (object): Function to map across image collection. Function must accept ee.Image as first argument</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>
<span class="sd">            **kwargs: arbitrary keyword to pass to `func`</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: copy of class with results from `func` as image within collection property</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get a partial function to map over imagery with the keywords applied</span>
        <span class="c1"># expects that the first positional arg is an</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for the `apply_func` method</span>

<span class="sd">        args:</span>
<span class="sd">            func (object): Function to map across image collection. Function must accept ee.Image as first argument</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>
<span class="sd">            **kwargs: arbitrary keyword to pass to `func`</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: copy of class with results from `func` as image within collection property</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper method for applying a filter to a datset collection.</span>

<span class="sd">        args:</span>
<span class="sd">            filter (ee.Filter): an `ee.Filter` object to apply to the dataset collection.</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns the dataset with the filtered collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper method for selecting bands from dataset collection</span>

<span class="sd">        args:</span>
<span class="sd">            *args: arbitrary arguments to pass to the `ee.ImageCollection.select()` method</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns the dataset with the collection with selected bands.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clip_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clips all of the images to the geographic extent defined by region.</span>
<span class="sd">        Useful for setting geometries on unbounded imagery in collection (e.g. MODIS or VIIRS imagery)</span>

<span class="sd">        args:</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset with imagery clipped to self.region or none depending on inplace</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
        <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Closure function to perform the clipping while carrying metadata&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">))</span>

        <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Merge the collection of two datasets into one where self.collection will contain imagery from self and dataset arg.</span>
<span class="sd">        Results will be sorted by time</span>

<span class="sd">        args:</span>
<span class="sd">            dataset (Dataset): dataset object to merge</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset where collection is merged imagery or none depending on inplace</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Performs spatiotemporal join between self.collection and dataset.collection.</span>
<span class="sd">        Result will be a dataset where the collection is colocated imagery in space and time</span>

<span class="sd">        args:</span>
<span class="sd">            dataset (Dataset): dataset object to apply join with. Used as right in join operations</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset where collection with joined imagery or none depending on inplace</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_merge</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Closure func to take results from the join and combine into one image with overlaping region&quot;&quot;&quot;</span>
            <span class="n">join_coll</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

            <span class="n">img_geom</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">join_geom</span> <span class="o">=</span> <span class="n">join_coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">overlap</span> <span class="o">=</span> <span class="n">img_geom</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">join_geom</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">join_data</span> <span class="o">=</span> <span class="n">join_coll</span><span class="o">.</span><span class="n">mosaic</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">join_data</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>

        <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="c1"># get a time and space filter</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">And</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">maxDifference</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="s2">&quot;difference&quot;</span><span class="p">:</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>  <span class="c1"># One day in milliseconds</span>
                    <span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">),</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span>
                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;.geo&quot;</span><span class="p">,</span> <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;.geo&quot;</span><span class="p">,</span> <span class="s2">&quot;maxError&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="c1"># apply join on collections and save all results</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Join</span><span class="o">.</span><span class="n">saveAll</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="n">primary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="p">,</span> <span class="n">secondary</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">collection</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="nb">filter</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># map over all filtered imagery, mosaic joined matches, and add bands to imagery</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_merge</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">joined</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">aggregate_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">period_unit</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">,</span>
        <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
        <span class="n">rename</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">clip_to_area</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Aggregates multiple images into one based on time periods and a user defined reducer.</span>
<span class="sd">        Useful for mosaicing images from same date or time period.</span>
<span class="sd">        Expects the images in this dataset to be homogenous (same band names and types)</span>

<span class="sd">        args:</span>
<span class="sd">            dates (list[str], optional): list of dates defined as beginning time period of aggregatation. default = None,</span>
<span class="sd">                all available uniques dates in collection will be used</span>
<span class="sd">            period (int, optional): number of days to advance from dates for aggregation. default = 1</span>
<span class="sd">            period_unit (str, optional): time unit to advance period for aggregation. default = &quot;day&quot;</span>
<span class="sd">            reducer (str | ee.Reducer, optional): reducer to apply to images for aggregation, accepts string reducer name</span>
<span class="sd">                or ee.Reducer opbject, default = &quot;mean&quot;</span>
<span class="sd">            clip_to_area (bool): switch to clip imagery that has been merged to the overlaping region of imagery, default=False</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset.collection with aggregated imagery or none depending on inplace</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_aggregation</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Closure function to map through days and reduce data within a given time period&quot;&quot;&quot;</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">period_unit</span><span class="p">)</span>
            <span class="n">img</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
                <span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">)</span>
                <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">millis</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">rename</span><span class="p">:</span>
                <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">band_names</span><span class="p">)</span>

            <span class="n">geom</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
                <span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">outimg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">clip_to_area</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">geom</span><span class="p">),</span> <span class="n">img</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">outimg</span>

        <span class="k">if</span> <span class="n">dates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dates</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;YYYY-MM-dd&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dates</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

        <span class="n">band_names</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">())</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span>

        <span class="n">out_coll</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_aggregation</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">band_pass_adjustment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to apply linear band transformation to dataset image collection.</span>
<span class="sd">        Expects that dataset has properties `self.gain` and `self.bias` set</span>

<span class="sd">        args:</span>
<span class="sd">            img (ee.Image): image to apply regression on</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># linear regression coefficients for adjustment</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gain</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to pipe imagery within dataset through multiple functions at once.</span>
<span class="sd">        Assumes the first argument into piped functions are and ee.Image</span>

<span class="sd">        args:</span>
<span class="sd">            steps (list | tuple): iterable of functions/steps to apply to imagery.</span>
<span class="sd">                list must be in the form of (func,func) or with a tuple of function/keyword ((func,kwargs),func)</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset.collection with piped functions applied</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            s1 = hf.Sentinel1(ee.Geometry.Point(105.03,11.72),&quot;2019-10-03&quot;,&quot;2019-10-05&quot;)</span>
<span class="sd">            water = s1.pipe(</span>
<span class="sd">                (</span>
<span class="sd">                    hf.gamma_map, #apply speckle filter</span>
<span class="sd">                    (hf.egde_ostu,{&#39;initial_threshold:-16}) # apply water mapping</span>
<span class="sd">                )</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_piper</span><span class="p">(</span><span class="n">funcs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Closure function to nest list of functions&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                    <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">pipe</span> <span class="o">|</span> <span class="n">one_shotter</span> <span class="o">|</span> <span class="n">func</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">one_shotter</span>

        <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># loop through the steps and create partial funcs is kwargs are provided</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">func</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">step</span>

            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">step</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pfunc</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pfunc</span> <span class="o">=</span> <span class="n">func</span>

            <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pfunc</span><span class="p">)</span>

        <span class="c1"># get the piped function</span>
        <span class="k">if</span> <span class="n">keep_attrs</span><span class="p">:</span>
            <span class="n">one_shot</span> <span class="o">=</span> <span class="n">decorators</span><span class="o">.</span><span class="n">keep_attrs</span><span class="p">(</span><span class="n">_piper</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">one_shot</span> <span class="o">=</span> <span class="n">_piper</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>

        <span class="c1"># apply pipe to each image</span>
        <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">one_shot</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.collection">
<code class="codehilite language-python"><span class="n">collection</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>image collection object property wrapped by dataset</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.dates">
<code class="codehilite language-python"><span class="n">dates</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Dates of imagery contained in the image collection</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.n_images">
<code class="codehilite language-python"><span class="n">n_images</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Number of images contained in the dataset</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize Dataset class</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>ee.Geometry</code></td>
        <td><p>earth engine geometry object to filter image collection by</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_time</code></td>
        <td><code>str | datetime.datetime</code></td>
        <td><p>start time used to filter image collection</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_time</code></td>
        <td><code>str | datetime.datetime</code></td>
        <td><p>end time used to filter image collection</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of earth engine collection</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use an internal function qa().
Used for definining custom dataset objects</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AttributeError</code></td>
        <td><p>if qa() method is not defined and use_qa is True</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize Dataset class</span>

<span class="sd">    args:</span>
<span class="sd">        region (ee.Geometry): earth engine geometry object to filter image collection by</span>
<span class="sd">        start_time (str | datetime.datetime): start time used to filter image collection</span>
<span class="sd">        end_time (str | datetime.datetime): end time used to filter image collection</span>
<span class="sd">        asset_id (str): asset id of earth engine collection</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use an internal function qa().</span>
<span class="sd">            Used for definining custom dataset objects</span>

<span class="sd">    raises:</span>
<span class="sd">        AttributeError: if qa() method is not defined and use_qa is True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: add exceptions to check datatypes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>  <span class="c1"># dtype = ee.Geometry</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">end_time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="n">asset_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_qa</span> <span class="o">=</span> <span class="n">use_qa</span>

    <span class="c1"># dictionary mapping of band names used to harmonized optical datasets to same names</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;landsat7&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;SR_B1&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;landsat8&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;SR_B2&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B6&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B7&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;viirs&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;M2&quot;</span><span class="p">,</span> <span class="s2">&quot;M4&quot;</span><span class="p">,</span> <span class="s2">&quot;I1&quot;</span><span class="p">,</span> <span class="s2">&quot;I2&quot;</span><span class="p">,</span> <span class="s2">&quot;I3&quot;</span><span class="p">,</span> <span class="s2">&quot;M11&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;sen2&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B8&quot;</span><span class="p">,</span> <span class="s2">&quot;B11&quot;</span><span class="p">,</span> <span class="s2">&quot;B12&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;modis&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s2">&quot;sur_refl_b03&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sur_refl_b04&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sur_refl_b01&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sur_refl_b02&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sur_refl_b06&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sur_refl_b07&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;new&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;nir&quot;</span><span class="p">,</span> <span class="s2">&quot;swir1&quot;</span><span class="p">,</span> <span class="s2">&quot;swir2&quot;</span><span class="p">]),</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># get the image collection and filter by geographic region and date time</span>
    <span class="n">imgcollection</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asset_id</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># check if to apply arbitrary qa process on collection</span>
    <span class="c1"># qa function can be defined in custom objects extending dataset</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_qa</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">imgcollection</span> <span class="o">=</span> <span class="n">imgcollection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qa</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;qa() method is not defined...please define one or set `use_qa` to False&quot;</span>
            <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">imgcollection</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.aggregate_time">
<code class="codehilite language-python"><span class="n">aggregate_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">period_unit</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip_to_area</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Aggregates multiple images into one based on time periods and a user defined reducer.
Useful for mosaicing images from same date or time period.
Expects the images in this dataset to be homogenous (same band names and types)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dates</code></td>
        <td><code>list[str]</code></td>
        <td><p>list of dates defined as beginning time period of aggregatation. default = None,
all available uniques dates in collection will be used</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>period</code></td>
        <td><code>int</code></td>
        <td><p>number of days to advance from dates for aggregation. default = 1</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>period_unit</code></td>
        <td><code>str</code></td>
        <td><p>time unit to advance period for aggregation. default = "day"</p></td>
        <td><code>&#39;day&#39;</code></td>
      </tr>
      <tr>
        <td><code>reducer</code></td>
        <td><code>str | ee.Reducer</code></td>
        <td><p>reducer to apply to images for aggregation, accepts string reducer name
or ee.Reducer opbject, default = "mean"</p></td>
        <td><code>&#39;mean&#39;</code></td>
      </tr>
      <tr>
        <td><code>clip_to_area</code></td>
        <td><code>bool</code></td>
        <td><p>switch to clip imagery that has been merged to the overlaping region of imagery, default=False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset.collection with aggregated imagery or none depending on inplace</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">period_unit</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">,</span>
    <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">rename</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">clip_to_area</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Aggregates multiple images into one based on time periods and a user defined reducer.</span>
<span class="sd">    Useful for mosaicing images from same date or time period.</span>
<span class="sd">    Expects the images in this dataset to be homogenous (same band names and types)</span>

<span class="sd">    args:</span>
<span class="sd">        dates (list[str], optional): list of dates defined as beginning time period of aggregatation. default = None,</span>
<span class="sd">            all available uniques dates in collection will be used</span>
<span class="sd">        period (int, optional): number of days to advance from dates for aggregation. default = 1</span>
<span class="sd">        period_unit (str, optional): time unit to advance period for aggregation. default = &quot;day&quot;</span>
<span class="sd">        reducer (str | ee.Reducer, optional): reducer to apply to images for aggregation, accepts string reducer name</span>
<span class="sd">            or ee.Reducer opbject, default = &quot;mean&quot;</span>
<span class="sd">        clip_to_area (bool): switch to clip imagery that has been merged to the overlaping region of imagery, default=False</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset.collection with aggregated imagery or none depending on inplace</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_aggregation</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closure function to map through days and reduce data within a given time period&quot;&quot;&quot;</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">period_unit</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">millis</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">rename</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">band_names</span><span class="p">)</span>

        <span class="n">geom</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">outimg</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">clip_to_area</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">geom</span><span class="p">),</span> <span class="n">img</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">outimg</span>

    <span class="k">if</span> <span class="n">dates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;YYYY-MM-dd&quot;</span><span class="p">))</span>
            <span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

    <span class="n">band_names</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">first</span><span class="p">())</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span>

    <span class="n">out_coll</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_aggregation</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.apply">
<code class="codehilite language-python"><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Alias for the <code>apply_func</code> method</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>func</code></td>
        <td><code>object</code></td>
        <td><p>Function to map across image collection. Function must accept ee.Image as first argument</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>arbitrary keyword to pass to <code>func</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>copy of class with results from <code>func</code> as image within collection property</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Alias for the `apply_func` method</span>

<span class="sd">    args:</span>
<span class="sd">        func (object): Function to map across image collection. Function must accept ee.Image as first argument</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>
<span class="sd">        **kwargs: arbitrary keyword to pass to `func`</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: copy of class with results from `func` as image within collection property</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.apply_func">
<code class="codehilite language-python"><span class="n">apply_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Wrapper method to apply a function to all of the image in the dataset.
Makes a copy of the collection and reassigns the image collection property.
Function must accept an ee.ImageCollection and return an ee.ImageCollection</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>func</code></td>
        <td><code>object</code></td>
        <td><p>Function to map across image collection. Function must accept ee.Image as first argument</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>arbitrary keyword to pass to <code>func</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>copy of class with results from <code>func</code> as image within collection property</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">apply_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper method to apply a function to all of the image in the dataset.</span>
<span class="sd">    Makes a copy of the collection and reassigns the image collection property.</span>
<span class="sd">    Function must accept an ee.ImageCollection and return an ee.ImageCollection</span>

<span class="sd">    args:</span>
<span class="sd">        func (object): Function to map across image collection. Function must accept ee.Image as first argument</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>
<span class="sd">        **kwargs: arbitrary keyword to pass to `func`</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: copy of class with results from `func` as image within collection property</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get a partial function to map over imagery with the keywords applied</span>
    <span class="c1"># expects that the first positional arg is an</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.band_pass_adjustment">
<code class="codehilite language-python"><span class="n">band_pass_adjustment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to apply linear band transformation to dataset image collection.
Expects that dataset has properties <code>self.gain</code> and <code>self.bias</code> set</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img</code></td>
        <td><code>ee.Image</code></td>
        <td><p>image to apply regression on</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">band_pass_adjustment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Method to apply linear band transformation to dataset image collection.</span>
<span class="sd">    Expects that dataset has properties `self.gain` and `self.bias` set</span>

<span class="sd">    args:</span>
<span class="sd">        img (ee.Image): image to apply regression on</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># linear regression coefficients for adjustment</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">img</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gain</span><span class="p">)</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>
        <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">))</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.clip_to_region">
<code class="codehilite language-python"><span class="n">clip_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Clips all of the images to the geographic extent defined by region.
Useful for setting geometries on unbounded imagery in collection (e.g. MODIS or VIIRS imagery)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset with imagery clipped to self.region or none depending on inplace</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clip_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clips all of the images to the geographic extent defined by region.</span>
<span class="sd">    Useful for setting geometries on unbounded imagery in collection (e.g. MODIS or VIIRS imagery)</span>

<span class="sd">    args:</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset with imagery clipped to self.region or none depending on inplace</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closure function to perform the clipping while carrying metadata&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">))</span>

    <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.copy">
<code class="codehilite language-python"><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>returns a deep copy of the hydrafloods dataset class</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;returns a deep copy of the hydrafloods dataset class&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.filter">
<code class="codehilite language-python"><span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Wrapper method for applying a filter to a datset collection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filter</code></td>
        <td><code>ee.Filter</code></td>
        <td><p>an <code>ee.Filter</code> object to apply to the dataset collection.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns the dataset with the filtered collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper method for applying a filter to a datset collection.</span>

<span class="sd">    args:</span>
<span class="sd">        filter (ee.Filter): an `ee.Filter` object to apply to the dataset collection.</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns the dataset with the filtered collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.from_imgcollection">
<code class="codehilite language-python"><span class="n">from_imgcollection</span><span class="p">(</span><span class="n">img_collection</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Static method to convert an ee.ImageCollection object to a hf.Dataset object.
This method will take some time as it uses computed ee Objects from the image collection
propeties to populate the Dataset object properties (passing info from server to client)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img_collection</code></td>
        <td><code>ee.ImageCollection</code></td>
        <td><p>computed ee.ImageCollection object to create a hf.Dataset</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>hf.Dataset</code></td>
      <td><p>dataset object with property information directly from the ee.ImageCollection</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_imgcollection</span><span class="p">(</span><span class="n">img_collection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Static method to convert an ee.ImageCollection object to a hf.Dataset object.</span>
<span class="sd">    This method will take some time as it uses computed ee Objects from the image collection</span>
<span class="sd">    propeties to populate the Dataset object properties (passing info from server to client)</span>

<span class="sd">    args:</span>
<span class="sd">        img_collection (ee.ImageCollection): computed ee.ImageCollection object to create a hf.Dataset</span>

<span class="sd">    returns:</span>
<span class="sd">        hf.Dataset: dataset object with property information directly from the ee.ImageCollection</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get region and date information</span>
    <span class="n">region</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">img_collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span>
        <span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">maxError</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="n">maxError</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># convert ee.Date info to string format</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">img_collection</span><span class="o">.</span><span class="n">aggregate_array</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ee</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;YYYY-MM-dd HH:mm:ss.S&quot;</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="c1"># pull the date info to local strings</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>

    <span class="c1"># get the collection id for `.asset_id` property</span>
    <span class="n">collection_id</span> <span class="o">=</span> <span class="n">img_collection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">collection_id</span> <span class="o">==</span> <span class="s2">&quot;None&quot;</span><span class="p">:</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;Custom ImageCollection&quot;</span>

    <span class="c1"># make a dummy dataset</span>
    <span class="n">dummy_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span>
        <span class="n">region</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">,</span>
        <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;NOAA/VIIRS/001/VNP09GA&quot;</span><span class="p">,</span>
        <span class="n">use_qa</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># override the dummy dataset information with the correct data fr</span>
    <span class="n">dummy_ds</span><span class="o">.</span><span class="n">asset_id</span> <span class="o">=</span> <span class="n">collection_id</span>
    <span class="n">dummy_ds</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">img_collection</span>

    <span class="k">return</span> <span class="n">dummy_ds</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.join">
<code class="codehilite language-python"><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Performs spatiotemporal join between self.collection and dataset.collection.
Result will be a dataset where the collection is colocated imagery in space and time</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset</code></td>
        <td><code>Dataset</code></td>
        <td><p>dataset object to apply join with. Used as right in join operations</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset where collection with joined imagery or none depending on inplace</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs spatiotemporal join between self.collection and dataset.collection.</span>
<span class="sd">    Result will be a dataset where the collection is colocated imagery in space and time</span>

<span class="sd">    args:</span>
<span class="sd">        dataset (Dataset): dataset object to apply join with. Used as right in join operations</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset where collection with joined imagery or none depending on inplace</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_merge</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closure func to take results from the join and combine into one image with overlaping region&quot;&quot;&quot;</span>
        <span class="n">join_coll</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="o">.</span><span class="n">fromImages</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

        <span class="n">img_geom</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">join_geom</span> <span class="o">=</span> <span class="n">join_coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">get_geoms</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">overlap</span> <span class="o">=</span> <span class="n">img_geom</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">join_geom</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">join_data</span> <span class="o">=</span> <span class="n">join_coll</span><span class="o">.</span><span class="n">mosaic</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">join_data</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>

    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="c1"># get a time and space filter</span>
    <span class="nb">filter</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">And</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">maxDifference</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="s2">&quot;difference&quot;</span><span class="p">:</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">,</span>  <span class="c1"># One day in milliseconds</span>
                <span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span>
                <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;system:time_start&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">),</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span><span class="s2">&quot;leftField&quot;</span><span class="p">:</span> <span class="s2">&quot;.geo&quot;</span><span class="p">,</span> <span class="s2">&quot;rightField&quot;</span><span class="p">:</span> <span class="s2">&quot;.geo&quot;</span><span class="p">,</span> <span class="s2">&quot;maxError&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># apply join on collections and save all results</span>
    <span class="n">joined</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Join</span><span class="o">.</span><span class="n">saveAll</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">primary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="p">,</span> <span class="n">secondary</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">collection</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="nb">filter</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># map over all filtered imagery, mosaic joined matches, and add bands to imagery</span>
    <span class="n">joined</span> <span class="o">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_merge</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">joined</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.merge">
<code class="codehilite language-python"><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Merge the collection of two datasets into one where self.collection will contain imagery from self and dataset arg.
Results will be sorted by time</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset</code></td>
        <td><code>Dataset</code></td>
        <td><p>dataset object to merge</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset where collection is merged imagery or none depending on inplace</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge the collection of two datasets into one where self.collection will contain imagery from self and dataset arg.</span>
<span class="sd">    Results will be sorted by time</span>

<span class="sd">    args:</span>
<span class="sd">        dataset (Dataset): dataset object to merge</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset where collection is merged imagery or none depending on inplace</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">collection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;system:time_start&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.pipe">
<code class="codehilite language-python"><span class="n">pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to pipe imagery within dataset through multiple functions at once.
Assumes the first argument into piped functions are and ee.Image</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>steps</code></td>
        <td><code>list | tuple</code></td>
        <td><p>iterable of functions/steps to apply to imagery.
list must be in the form of (func,func) or with a tuple of function/keyword ((func,kwargs),func)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset.collection with piped functions applied</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="n">s1</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Sentinel1</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mf">105.03</span><span class="p">,</span><span class="mf">11.72</span><span class="p">),</span><span class="s2">&quot;2019-10-03&quot;</span><span class="p">,</span><span class="s2">&quot;2019-10-05&quot;</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="n">hf</span><span class="o">.</span><span class="n">gamma_map</span><span class="p">,</span> <span class="c1">#apply speckle filter</span>
        <span class="p">(</span><span class="n">hf</span><span class="o">.</span><span class="n">egde_ostu</span><span class="p">,{</span><span class="s1">&#39;initial_threshold:-16}) # apply water mapping</span>
    <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Method to pipe imagery within dataset through multiple functions at once.</span>
<span class="sd">    Assumes the first argument into piped functions are and ee.Image</span>

<span class="sd">    args:</span>
<span class="sd">        steps (list | tuple): iterable of functions/steps to apply to imagery.</span>
<span class="sd">            list must be in the form of (func,func) or with a tuple of function/keyword ((func,kwargs),func)</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset.collection with piped functions applied</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        s1 = hf.Sentinel1(ee.Geometry.Point(105.03,11.72),&quot;2019-10-03&quot;,&quot;2019-10-05&quot;)</span>
<span class="sd">        water = s1.pipe(</span>
<span class="sd">            (</span>
<span class="sd">                hf.gamma_map, #apply speckle filter</span>
<span class="sd">                (hf.egde_ostu,{&#39;initial_threshold:-16}) # apply water mapping</span>
<span class="sd">            )</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_piper</span><span class="p">(</span><span class="n">funcs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closure function to nest list of functions&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">pipe</span> <span class="o">|</span> <span class="n">one_shotter</span> <span class="o">|</span> <span class="n">func</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">one_shotter</span> <span class="o">=</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">one_shotter</span>

    <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># loop through the steps and create partial funcs is kwargs are provided</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">func</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">step</span>

        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">step</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pfunc</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pfunc</span> <span class="o">=</span> <span class="n">func</span>

        <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pfunc</span><span class="p">)</span>

    <span class="c1"># get the piped function</span>
    <span class="k">if</span> <span class="n">keep_attrs</span><span class="p">:</span>
        <span class="n">one_shot</span> <span class="o">=</span> <span class="n">decorators</span><span class="o">.</span><span class="n">keep_attrs</span><span class="p">(</span><span class="n">_piper</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">one_shot</span> <span class="o">=</span> <span class="n">_piper</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># apply pipe to each image</span>
    <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">img</span><span class="p">:</span> <span class="n">one_shot</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">out_coll</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Dataset.select">
<code class="codehilite language-python"><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Wrapper method for selecting bands from dataset collection</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>arbitrary arguments to pass to the <code>ee.ImageCollection.select()</code> method</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns the dataset with the collection with selected bands.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper method for selecting bands from dataset collection</span>

<span class="sd">    args:</span>
<span class="sd">        *args: arbitrary arguments to pass to the `ee.ImageCollection.select()` method</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns the dataset with the collection with selected bands.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inplace_wrapper</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1">
        <code>
hydrafloods.datasets.Sentinel1            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Class extending dataset for the Sentinel 1 collection
This Sentinel 1 dataset is in backscatter units</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Sentinel1</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class extending dataset for the Sentinel 1 collection</span>
<span class="sd">    This Sentinel 1 dataset is in backscatter units</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Sentinel1 Dataset class</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the Sentinel 1 earth engine collection. default=&quot;COPERNICUS/S1_GRD&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sentinel1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">listContains</span><span class="p">(</span><span class="s2">&quot;transmitterReceiverPolarisation&quot;</span><span class="p">,</span> <span class="s2">&quot;VH&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for Sentinel1 backscatter based on view angle</span>
<span class="sd">        Angle threshold values taken from https://doi.org/10.3390/rs13101954</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">)</span>
        <span class="n">angle_mask</span> <span class="o">=</span> <span class="n">angle</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mf">45.23993</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">angle</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mf">30.63993</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">angle_mask</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_orbit_band</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to add orbit band from S1 image metadata</span>
<span class="sd">        Useful for determining if pixels are from ascending or descending orbits</span>

<span class="sd">        args:</span>
<span class="sd">            inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">        returns:</span>
<span class="sd">            Dataset | None: returns dataset.collection where imagery has the added bands</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_add_features</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Closure function to add features as bands to the images&quot;&quot;&quot;</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">orbit</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;orbitProperties_pass&quot;</span><span class="p">))</span>
            <span class="n">orbit_band</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span>
                <span class="n">orbit</span><span class="o">.</span><span class="n">compareTo</span><span class="p">(</span><span class="s2">&quot;DESCENDING&quot;</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">extraFeatures</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">orbit_band</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;orbit&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">extraFeatures</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">(</span><span class="n">_add_features</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convience method to convert units from power to db&quot;&quot;&quot;</span>
        <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">power_to_db</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outCls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">outCls</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
            <span class="k">return</span> <span class="n">outCls</span>

    <span class="k">def</span> <span class="nf">to_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convience method to convert units from db to power&quot;&quot;&quot;</span>
        <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">db_to_power</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outCls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">outCls</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
            <span class="k">return</span> <span class="n">outCls</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;COPERNICUS/S1_GRD&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize Sentinel1 Dataset class</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the Sentinel 1 earth engine collection. default="COPERNICUS/S1_GRD"</p></td>
        <td><code>&#39;COPERNICUS/S1_GRD&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;COPERNICUS/S1_GRD&quot;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize Sentinel1 Dataset class</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the Sentinel 1 earth engine collection. default=&quot;COPERNICUS/S1_GRD&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Sentinel1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">listContains</span><span class="p">(</span><span class="s2">&quot;transmitterReceiverPolarisation&quot;</span><span class="p">,</span> <span class="s2">&quot;VH&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1.add_orbit_band">
<code class="codehilite language-python"><span class="n">add_orbit_band</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to add orbit band from S1 image metadata
Useful for determining if pixels are from ascending or descending orbits</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>define whether to return another dataset object or update inplace. default = False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dataset | None</code></td>
      <td><p>returns dataset.collection where imagery has the added bands</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_orbit_band</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Method to add orbit band from S1 image metadata</span>
<span class="sd">    Useful for determining if pixels are from ascending or descending orbits</span>

<span class="sd">    args:</span>
<span class="sd">        inplace (bool, optional): define whether to return another dataset object or update inplace. default = False</span>

<span class="sd">    returns:</span>
<span class="sd">        Dataset | None: returns dataset.collection where imagery has the added bands</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_add_features</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closure function to add features as bands to the images&quot;&quot;&quot;</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">orbit</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;orbitProperties_pass&quot;</span><span class="p">))</span>
        <span class="n">orbit_band</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Algorithms</span><span class="o">.</span><span class="n">If</span><span class="p">(</span>
            <span class="n">orbit</span><span class="o">.</span><span class="n">compareTo</span><span class="p">(</span><span class="s2">&quot;DESCENDING&quot;</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">extraFeatures</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">orbit_band</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;orbit&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">addBands</span><span class="p">(</span><span class="n">extraFeatures</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">(</span><span class="n">_add_features</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for Sentinel1 backscatter based on view angle
Angle threshold values taken from https://doi.org/10.3390/rs13101954</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for Sentinel1 backscatter based on view angle</span>
<span class="sd">    Angle threshold values taken from https://doi.org/10.3390/rs13101954</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">)</span>
    <span class="n">angle_mask</span> <span class="o">=</span> <span class="n">angle</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mf">45.23993</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">angle</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mf">30.63993</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">angle_mask</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1.to_db">
<code class="codehilite language-python"><span class="n">to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Convience method to convert units from power to db</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convience method to convert units from power to db&quot;&quot;&quot;</span>
    <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">power_to_db</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">outCls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">outCls</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
        <span class="k">return</span> <span class="n">outCls</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel1.to_power">
<code class="codehilite language-python"><span class="n">to_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Convience method to convert units from db to power</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convience method to convert units from db to power&quot;&quot;&quot;</span>
    <span class="n">out_coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">geeutils</span><span class="o">.</span><span class="n">db_to_power</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">outCls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">outCls</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">out_coll</span>
        <span class="k">return</span> <span class="n">outCls</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Sentinel2">
        <code>
hydrafloods.datasets.Sentinel2            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Sentinel2</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;COPERNICUS/S2_SR&quot;</span><span class="p">,</span>
        <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Sentinel2 Dataset class</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the Sentinel2 earth engine collection. default=&quot;COPERNICUS/S2_SR&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">            rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sentinel2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sen2&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
            <span class="c1"># band bass adjustment coefficients taken HLS project https://hls.gsfc.nasa.gov/algorithms/bandpass-adjustment/</span>
            <span class="c1"># slope coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.9778</span><span class="p">,</span> <span class="mf">1.0053</span><span class="p">,</span> <span class="mf">0.9765</span><span class="p">,</span> <span class="mf">0.9983</span><span class="p">,</span> <span class="mf">0.9987</span><span class="p">,</span> <span class="mf">1.003</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># y-intercept coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.00411</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00093</span><span class="p">,</span> <span class="mf">0.00094</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0015</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
            <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for Sentinel2 surface reflectance dataset&quot;&quot;&quot;</span>
        <span class="n">CLD_PRB_THRESH</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="n">NIR_DRK_THRESH</span> <span class="o">=</span> <span class="mf">0.175</span> <span class="o">*</span> <span class="mf">1e4</span>
        <span class="n">CLD_PRJ_DIST</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">BUFFER</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">CRS</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span>

        <span class="c1"># Get s2cloudless image, subset the probability band.</span>
        <span class="n">cld_prb</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2_CLOUD_PROBABILITY&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;probability&quot;</span><span class="p">)</span>

        <span class="c1"># Condition s2cloudless by the probability threshold value.</span>
        <span class="n">is_cloud</span> <span class="o">=</span> <span class="n">cld_prb</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">CLD_PRB_THRESH</span><span class="p">)</span>

        <span class="c1"># Identify water pixels from the SCL band, invert.</span>
        <span class="n">not_water</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SCL&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">neq</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Identify dark NIR pixels that are not water (potential cloud shadow pixels).</span>
        <span class="n">dark_pixels</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;B8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">NIR_DRK_THRESH</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">not_water</span><span class="p">)</span>

        <span class="c1"># Determine the direction to project cloud shadow from clouds (assumes UTM projection).</span>
        <span class="n">shadow_azimuth</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MEAN_SOLAR_AZIMUTH_ANGLE&quot;</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Project shadows from clouds for the distance specified by the CLD_PRJ_DIST input.</span>
        <span class="n">cld_proj</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">is_cloud</span><span class="o">.</span><span class="n">directionalDistanceTransform</span><span class="p">(</span><span class="n">shadow_azimuth</span><span class="p">,</span> <span class="n">CLD_PRJ_DIST</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">CRS</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">})</span>
            <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;distance&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">mask</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># Identify the intersection of dark pixels with cloud shadow projection.</span>
        <span class="n">is_shadow</span> <span class="o">=</span> <span class="n">cld_proj</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dark_pixels</span><span class="p">)</span>

        <span class="c1"># Combine cloud and shadow mask, set cloud and shadow as value 1, else 0.</span>
        <span class="n">is_cld_shdw</span> <span class="o">=</span> <span class="n">is_cloud</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">is_shadow</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Remove small cloud-shadow patches and dilate remaining pixels by BUFFER input.</span>
        <span class="c1"># 20 m scale is for speed, and assumes clouds don&#39;t require 10 m precision.</span>
        <span class="n">is_cld_shdw</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">is_cld_shdw</span><span class="o">.</span><span class="n">focal_min</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">focal_max</span><span class="p">(</span><span class="n">BUFFER</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">CRS</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">})</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;cloudmask&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Subset reflectance bands and update their masks, return the result.</span>
        <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;B.*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">is_cld_shdw</span><span class="o">.</span><span class="n">Not</span><span class="p">())</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel2.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;COPERNICUS/S2_SR&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize Sentinel2 Dataset class</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the Sentinel2 earth engine collection. default="COPERNICUS/S2_SR"</p></td>
        <td><code>&#39;COPERNICUS/S2_SR&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>apply_band_adjustment</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rescale</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;COPERNICUS/S2_SR&quot;</span><span class="p">,</span>
    <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize Sentinel2 Dataset class</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the Sentinel2 earth engine collection. default=&quot;COPERNICUS/S2_SR&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">        rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Sentinel2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sen2&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
        <span class="c1"># band bass adjustment coefficients taken HLS project https://hls.gsfc.nasa.gov/algorithms/bandpass-adjustment/</span>
        <span class="c1"># slope coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.9778</span><span class="p">,</span> <span class="mf">1.0053</span><span class="p">,</span> <span class="mf">0.9765</span><span class="p">,</span> <span class="mf">0.9983</span><span class="p">,</span> <span class="mf">0.9987</span><span class="p">,</span> <span class="mf">1.003</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># y-intercept coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.00411</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00093</span><span class="p">,</span> <span class="mf">0.00094</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0015</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Sentinel2.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for Sentinel2 surface reflectance dataset</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for Sentinel2 surface reflectance dataset&quot;&quot;&quot;</span>
    <span class="n">CLD_PRB_THRESH</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">NIR_DRK_THRESH</span> <span class="o">=</span> <span class="mf">0.175</span> <span class="o">*</span> <span class="mf">1e4</span>
    <span class="n">CLD_PRJ_DIST</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">BUFFER</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">CRS</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">()</span>

    <span class="c1"># Get s2cloudless image, subset the probability band.</span>
    <span class="n">cld_prb</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s2">&quot;COPERNICUS/S2_CLOUD_PROBABILITY&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Filter</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system:index&quot;</span><span class="p">)))</span>
        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;probability&quot;</span><span class="p">)</span>

    <span class="c1"># Condition s2cloudless by the probability threshold value.</span>
    <span class="n">is_cloud</span> <span class="o">=</span> <span class="n">cld_prb</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">CLD_PRB_THRESH</span><span class="p">)</span>

    <span class="c1"># Identify water pixels from the SCL band, invert.</span>
    <span class="n">not_water</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SCL&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">neq</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Identify dark NIR pixels that are not water (potential cloud shadow pixels).</span>
    <span class="n">dark_pixels</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;B8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">NIR_DRK_THRESH</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">not_water</span><span class="p">)</span>

    <span class="c1"># Determine the direction to project cloud shadow from clouds (assumes UTM projection).</span>
    <span class="n">shadow_azimuth</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Number</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MEAN_SOLAR_AZIMUTH_ANGLE&quot;</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="c1"># Project shadows from clouds for the distance specified by the CLD_PRJ_DIST input.</span>
    <span class="n">cld_proj</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">is_cloud</span><span class="o">.</span><span class="n">directionalDistanceTransform</span><span class="p">(</span><span class="n">shadow_azimuth</span><span class="p">,</span> <span class="n">CLD_PRJ_DIST</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
        <span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">CRS</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">})</span>
        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;distance&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mask</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># Identify the intersection of dark pixels with cloud shadow projection.</span>
    <span class="n">is_shadow</span> <span class="o">=</span> <span class="n">cld_proj</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dark_pixels</span><span class="p">)</span>

    <span class="c1"># Combine cloud and shadow mask, set cloud and shadow as value 1, else 0.</span>
    <span class="n">is_cld_shdw</span> <span class="o">=</span> <span class="n">is_cloud</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">is_shadow</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Remove small cloud-shadow patches and dilate remaining pixels by BUFFER input.</span>
    <span class="c1"># 20 m scale is for speed, and assumes clouds don&#39;t require 10 m precision.</span>
    <span class="n">is_cld_shdw</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">is_cld_shdw</span><span class="o">.</span><span class="n">focal_min</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="o">.</span><span class="n">focal_max</span><span class="p">(</span><span class="n">BUFFER</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>
        <span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">CRS</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">})</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;cloudmask&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Subset reflectance bands and update their masks, return the result.</span>
    <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;B.*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">is_cld_shdw</span><span class="o">.</span><span class="n">Not</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Landsat8">
        <code>
hydrafloods.datasets.Landsat8            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Landsat8</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;LANDSAT/LC08/C02/T1_L2&quot;</span><span class="p">,</span>
        <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Landsat8 Dataset class</span>
<span class="sd">        Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the Landsat earth engine collection. default=&quot;LANDSAT/LC08/C01/T1_SR&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Landsat8</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;landsat8&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for Landsat8 surface reflectance dataset&quot;&quot;&quot;</span>
        <span class="n">qa_band</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA_PIXEL&quot;</span><span class="p">)</span>
        <span class="n">qa_flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;111111&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">sat_mask</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;QA_RADSAT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">qa_band</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">qa_flag</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sat_mask</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.0000275</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Landsat8.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;LANDSAT/LC08/C02/T1_L2&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize Landsat8 Dataset class
Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the Landsat earth engine collection. default="LANDSAT/LC08/C01/T1_SR"</p></td>
        <td><code>&#39;LANDSAT/LC08/C02/T1_L2&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>rescale</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;LANDSAT/LC08/C02/T1_L2&quot;</span><span class="p">,</span>
    <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize Landsat8 Dataset class</span>
<span class="sd">    Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the Landsat earth engine collection. default=&quot;LANDSAT/LC08/C01/T1_SR&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Landsat8</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;landsat8&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Landsat8.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for Landsat8 surface reflectance dataset</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for Landsat8 surface reflectance dataset&quot;&quot;&quot;</span>
    <span class="n">qa_band</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA_PIXEL&quot;</span><span class="p">)</span>
    <span class="n">qa_flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;111111&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sat_mask</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;QA_RADSAT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">qa_band</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">qa_flag</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sat_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.0000275</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Landsat7">
        <code>
hydrafloods.datasets.Landsat7            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Landsat7</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;LANDSAT/LE07/C02/T1_L2&quot;</span><span class="p">,</span>
        <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Landsat7 Dataset class</span>
<span class="sd">        Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the Landsat7 earth engine collection. default=&quot;LANDSAT/LE07/C01/T1_SR&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">            rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Landsat7</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;landsat7&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
            <span class="c1"># band bass adjustment coefficients taken from Roy et al., 2016 http://dx.doi.org/10.1016/j.rse.2015.12.024</span>
            <span class="c1"># slope coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.8474</span><span class="p">,</span> <span class="mf">0.8483</span><span class="p">,</span> <span class="mf">0.9047</span><span class="p">,</span> <span class="mf">0.8462</span><span class="p">,</span> <span class="mf">0.8937</span><span class="p">,</span> <span class="mf">0.9071</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># y-intercept coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.0003</span><span class="p">,</span> <span class="mf">0.0088</span><span class="p">,</span> <span class="mf">0.0061</span><span class="p">,</span> <span class="mf">0.0412</span><span class="p">,</span> <span class="mf">0.0254</span><span class="p">,</span> <span class="mf">0.0172</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
            <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for Landsat7 surface reflectance dataset&quot;&quot;&quot;</span>
        <span class="n">qa_band</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA_PIXEL&quot;</span><span class="p">)</span>
        <span class="n">qa_flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;111111&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">sat_mask</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;QA_RADSAT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">qa_band</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">qa_flag</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sat_mask</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.0000275</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Landsat7.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;LANDSAT/LE07/C02/T1_L2&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize Landsat7 Dataset class
Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the Landsat7 earth engine collection. default="LANDSAT/LE07/C01/T1_SR"</p></td>
        <td><code>&#39;LANDSAT/LE07/C02/T1_L2&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>apply_band_adjustment</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rescale</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;LANDSAT/LE07/C02/T1_L2&quot;</span><span class="p">,</span>
    <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize Landsat7 Dataset class</span>
<span class="sd">    Can theoretically be useds with any Landsat surface reflectance collection (e.g. LANDSAT/LT05/C01/T1_SR)</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the Landsat7 earth engine collection. default=&quot;LANDSAT/LE07/C01/T1_SR&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">        rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Landsat7</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;landsat7&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
        <span class="c1"># band bass adjustment coefficients taken from Roy et al., 2016 http://dx.doi.org/10.1016/j.rse.2015.12.024</span>
        <span class="c1"># slope coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.8474</span><span class="p">,</span> <span class="mf">0.8483</span><span class="p">,</span> <span class="mf">0.9047</span><span class="p">,</span> <span class="mf">0.8462</span><span class="p">,</span> <span class="mf">0.8937</span><span class="p">,</span> <span class="mf">0.9071</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># y-intercept coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0003</span><span class="p">,</span> <span class="mf">0.0088</span><span class="p">,</span> <span class="mf">0.0061</span><span class="p">,</span> <span class="mf">0.0412</span><span class="p">,</span> <span class="mf">0.0254</span><span class="p">,</span> <span class="mf">0.0172</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Landsat7.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for Landsat7 surface reflectance dataset</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for Landsat7 surface reflectance dataset&quot;&quot;&quot;</span>
    <span class="n">qa_band</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QA_PIXEL&quot;</span><span class="p">)</span>
    <span class="n">qa_flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;111111&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sat_mask</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;QA_RADSAT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">qa_band</span><span class="o">.</span><span class="n">bitwiseAnd</span><span class="p">(</span><span class="n">qa_flag</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sat_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.0000275</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Viirs">
        <code>
hydrafloods.datasets.Viirs            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Viirs</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;NOAA/VIIRS/001/VNP09GA&quot;</span><span class="p">,</span>
        <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize VIIRS Dataset class</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the VIIRS earth engine collection. default=&quot;NOAA/VIIRS/001/VNP09GA&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">            rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Viirs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># get the bands and rename to common optical names</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;viirs&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
            <span class="c1"># band bass adjustment coefficients taken calculated from https://code.earthengine.google.com/876f53861690e483fb3e3439a3571f27</span>
            <span class="c1"># slope coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.68328</span><span class="p">,</span> <span class="mf">0.66604</span><span class="p">,</span> <span class="mf">0.78901</span><span class="p">,</span> <span class="mf">0.95324</span><span class="p">,</span> <span class="mf">0.98593</span><span class="p">,</span> <span class="mf">0.88941</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># y-intercept coefficients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
                <span class="p">[</span><span class="mf">0.016728</span><span class="p">,</span> <span class="mf">0.030814</span><span class="p">,</span> <span class="mf">0.023199</span><span class="p">,</span> <span class="mf">0.036571</span><span class="p">,</span> <span class="mf">0.026923</span><span class="p">,</span> <span class="mf">0.021615</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
            <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for VIIRS VNP09GA dataset&quot;&quot;&quot;</span>
        <span class="n">cloudMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF1&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_qa&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">shadowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span>
            <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF2&quot;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;shadow_qa&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
        <span class="n">snowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF2&quot;</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;snow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
        <span class="n">sensorZenith</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SensorZenith&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>

        <span class="n">env_mask</span> <span class="o">=</span> <span class="n">cloudMask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">shadowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sensorZenith</span><span class="p">)</span>

        <span class="c1"># internal pixel quality masks</span>
        <span class="n">pixal_quality_3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF3&quot;</span><span class="p">)</span>
        <span class="n">pixal_quality_4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF4&quot;</span><span class="p">)</span>
        <span class="n">m2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m2_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m4_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m4_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">m11_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m11_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">i1_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">i2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i2_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">i3_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i3_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">qual_mask</span> <span class="o">=</span> <span class="n">m2_qual</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">m4_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">m11_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i1_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i2_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i3_qual</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">env_mask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qual_mask</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Viirs.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;NOAA/VIIRS/001/VNP09GA&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize VIIRS Dataset class</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the VIIRS earth engine collection. default="NOAA/VIIRS/001/VNP09GA"</p></td>
        <td><code>&#39;NOAA/VIIRS/001/VNP09GA&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>apply_band_adjustment</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rescale</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;NOAA/VIIRS/001/VNP09GA&quot;</span><span class="p">,</span>
    <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">apply_band_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize VIIRS Dataset class</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the VIIRS earth engine collection. default=&quot;NOAA/VIIRS/001/VNP09GA&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        apply_band_adjustment (bool, optional): boolean switch to apply linear band pass equation to convert values to Landsat8. default=False</span>
<span class="sd">        rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Viirs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># get the bands and rename to common optical names</span>
    <span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;viirs&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">apply_band_adjustment</span><span class="p">:</span>
        <span class="c1"># band bass adjustment coefficients taken calculated from https://code.earthengine.google.com/876f53861690e483fb3e3439a3571f27</span>
        <span class="c1"># slope coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.68328</span><span class="p">,</span> <span class="mf">0.66604</span><span class="p">,</span> <span class="mf">0.78901</span><span class="p">,</span> <span class="mf">0.95324</span><span class="p">,</span> <span class="mf">0.98593</span><span class="p">,</span> <span class="mf">0.88941</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># y-intercept coefficients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.016728</span><span class="p">,</span> <span class="mf">0.030814</span><span class="p">,</span> <span class="mf">0.023199</span><span class="p">,</span> <span class="mf">0.036571</span><span class="p">,</span> <span class="mf">0.026923</span><span class="p">,</span> <span class="mf">0.021615</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="n">coll</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">band_pass_adjustment</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="n">coll</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Viirs.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for VIIRS VNP09GA dataset</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for VIIRS VNP09GA dataset&quot;&quot;&quot;</span>
    <span class="n">cloudMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span>
        <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF1&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_qa&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">shadowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span>
        <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF2&quot;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;shadow_qa&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
    <span class="n">snowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF2&quot;</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;snow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
    <span class="n">sensorZenith</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SensorZenith&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>

    <span class="n">env_mask</span> <span class="o">=</span> <span class="n">cloudMask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">shadowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sensorZenith</span><span class="p">)</span>

    <span class="c1"># internal pixel quality masks</span>
    <span class="n">pixal_quality_3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF3&quot;</span><span class="p">)</span>
    <span class="n">pixal_quality_4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QF4&quot;</span><span class="p">)</span>
    <span class="n">m2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m2_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">m4_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m4_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">m11_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;m11_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">i1_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">i2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i2_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">i3_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality_4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;i3_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">qual_mask</span> <span class="o">=</span> <span class="n">m2_qual</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">m4_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">m11_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i1_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i2_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">i3_qual</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">env_mask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qual_mask</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="hydrafloods.datasets.Modis">
        <code>
hydrafloods.datasets.Modis            (<a title="hydrafloods.datasets.Dataset" href="#hydrafloods.datasets.Dataset">Dataset</a>)
        </code>



</h2>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Modis</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;MODIS/006/MOD09GA&quot;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize MODIS Dataset class</span>
<span class="sd">        Can be used with MOD09GA and MYD09GA</span>

<span class="sd">        args:</span>
<span class="sd">            *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">            asset_id (str): asset id of the MODIS earth engine collection. default=&quot;MODIS/006/MOD09GA&quot;</span>
<span class="sd">            use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">            rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">            **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Modis</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;modis&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span>

    <span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
    <span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom QA masking method for MODIS MXD09GA dataset&quot;&quot;&quot;</span>
        <span class="c1"># internal env masks</span>
        <span class="n">qa</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;state_1km&quot;</span><span class="p">)</span>
        <span class="n">cloudMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">shadowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;shadow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
        <span class="n">snowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;snow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
        <span class="n">cloudAdjMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_adjacency_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
        <span class="n">sensorZenith</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SensorZenith&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>
        <span class="n">env_mask</span> <span class="o">=</span> <span class="n">cloudMask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">shadowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">snowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sensorZenith</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">cloudAdjMask</span><span class="p">)</span>

        <span class="c1"># internal pixel quality masks</span>
        <span class="n">pixal_quality</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QC_500m&quot;</span><span class="p">)</span>
        <span class="n">b1_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b3_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b4_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b6_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b7_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">qual_mask</span> <span class="o">=</span> <span class="n">b1_qual</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b2_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b3_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b4_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b6_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b7_qual</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">env_mask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qual_mask</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Modis.__init__">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s1">&#39;MODIS/006/MOD09GA&#39;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize MODIS Dataset class
Can be used with MOD09GA and MYD09GA</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>*args</code></td>
        <td></td>
        <td><p>positional arguments to pass to <code>Dataset</code> (i.e. <code>region</code>, <code>start_time</code>, <code>end_time</code>)</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>asset_id</code></td>
        <td><code>str</code></td>
        <td><p>asset id of the MODIS earth engine collection. default="MODIS/006/MOD09GA"</p></td>
        <td><code>&#39;MODIS/006/MOD09GA&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_qa</code></td>
        <td><code>bool</code></td>
        <td><p>boolean to determine to use a private <code>self.qa()</code> function. default=True</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>rescale</code></td>
        <td><code>bool</code></td>
        <td><p>boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>optional</code></td>
        <td><p>addtional arbitrary keywords to pass to <code>Dataset</code></p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;MODIS/006/MOD09GA&quot;</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize MODIS Dataset class</span>
<span class="sd">    Can be used with MOD09GA and MYD09GA</span>

<span class="sd">    args:</span>
<span class="sd">        *args: positional arguments to pass to `Dataset` (i.e. `region`, `start_time`, `end_time`)</span>
<span class="sd">        asset_id (str): asset id of the MODIS earth engine collection. default=&quot;MODIS/006/MOD09GA&quot;</span>
<span class="sd">        use_qa (bool, optional): boolean to determine to use a private `self.qa()` function. default=True</span>
<span class="sd">        rescale (bool, optional): boolean switch to convert units from scaled int (0-10000) to float (0-1). If false values will be scaled int. default = False</span>
<span class="sd">        **kwargs (optional): addtional arbitrary keywords to pass to `Dataset`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Modis</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">asset_id</span><span class="o">=</span><span class="n">asset_id</span><span class="p">,</span> <span class="n">use_qa</span><span class="o">=</span><span class="n">use_qa</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;modis&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">BANDREMAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="hydrafloods.datasets.Modis.qa">
<code class="codehilite language-python"><span class="n">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Custom QA masking method for MODIS MXD09GA dataset</p>

        <details class="quote">
          <summary>Source code in <code>hydrafloods/datasets.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@decorators</span><span class="o">.</span><span class="n">keep_attrs</span>
<span class="k">def</span> <span class="nf">qa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom QA masking method for MODIS MXD09GA dataset&quot;&quot;&quot;</span>
    <span class="c1"># internal env masks</span>
    <span class="n">qa</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;state_1km&quot;</span><span class="p">)</span>
    <span class="n">cloudMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">shadowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;shadow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
    <span class="n">snowMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;snow_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
    <span class="n">cloudAdjMask</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">qa</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;cloud_adjacency_qa&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Not</span><span class="p">()</span>
    <span class="n">sensorZenith</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;SensorZenith&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>
    <span class="n">env_mask</span> <span class="o">=</span> <span class="n">cloudMask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">shadowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">snowMask</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">sensorZenith</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">cloudAdjMask</span><span class="p">)</span>

    <span class="c1"># internal pixel quality masks</span>
    <span class="n">pixal_quality</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;QC_500m&quot;</span><span class="p">)</span>
    <span class="n">b1_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b2_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b3_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b4_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b6_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b7_qual</span> <span class="o">=</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">extract_bits</span><span class="p">(</span><span class="n">pixal_quality</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;b1_quality&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">qual_mask</span> <span class="o">=</span> <span class="n">b1_qual</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b2_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b3_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b4_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b6_qual</span><span class="p">)</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">b7_qual</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">env_mask</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">qual_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">geeutils</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../corrections/" class="md-footer__link md-footer__link--prev" aria-label="Previous: corrections module" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              corrections module
            </div>
          </div>
        </a>
      
      
        
        <a href="../depths/" class="md-footer__link md-footer__link--next" aria-label="Next: depths module" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              depths module
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>